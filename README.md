This is the code from my graduate thesis.  It was written 15 years ago.